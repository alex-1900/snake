!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(t,e,n){"use strict";var r=window.URL||window.webkitURL;t.exports=function(t,e){try{try{var n;try{(n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(t),n=n.getBlob()}catch(e){n=new Blob([t])}return new Worker(r.createObjectURL(n))}catch(e){return new Worker("data:application/javascript,"+encodeURIComponent(t))}}catch(t){if(!e)throw Error("Inline worker is not supported");return new Worker(e)}}},function(t,e,n){t.exports=function(){return n(0)('!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var n=self;n.addEventListener("message",(function(e){var t=e.data,r=t[0],o=t[1],u=r,a=2.8*t[2],f=o-r,i=Math.abs(f),l=Math.min(i,a);i<=180?u+=f>0?l:-l:i>180&&(u+=f>0?-l:l),u>360&&(u-=360),u<0&&(u+=360),i<a&&(u=o),n.postMessage(Math.floor(u))})),t.default=null}]);',n.p+"65f846fcf521b26f5c99.worker.js")}},function(t,e,n){t.exports=function(){return n(0)('!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r=self,o=180/Math.PI;r.addEventListener("message",(function(t){var e=t.data,n=e[0],a=e[1],u=e[2],f=e[3],l=e[4],i=e[5],c=e[6];r.postMessage(function(t,e,n,r,a,u,f){return t>a&&e>u?Math.floor(Math.atan(r/n)*o)+(f?0:360):t<a&&e>u?Math.floor(Math.atan(-n/r)*o)+90:t<a&&e<u?Math.floor(Math.atan(-r/-n)*o)+180:t>a&&e<u?Math.floor(Math.atan(-n/r)*o)+270:0}(n,a,u,f,l,i,c))})),e.default=null}]);',n.p+"b3b2557e0299f7aabd91.worker.js")}},function(t,e,n){t.exports=function(){return n(0)('!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var n=self;n.addEventListener("message",(function(e){var t,r,o,u,a,f,i,l=e.data,c=l[0],s=l[1],d=l[2],p=l[3],b=l[4],y=l[5],v=l[6],g=d/2;t=c+g,r=s+d/3,o=g,u=p,a=b,f=4,i=Math.sqrt(Math.pow(t-u,2)+Math.pow(r-a,2)),Boolean(o+f+40>=i)&&n.postMessage([y,v])})),t.default=null}]);',n.p+"7d78585cfc9e388ca567.worker.js")}},function(t,e,n){var r=n(5),o=n(6);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]);var i={insert:"head",singleton:!1},a=(r(o,i),o.locals?o.locals:{});t.exports=a},function(t,e,n){"use strict";var r,o=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},i=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),a=[];function s(t){for(var e=-1,n=0;n<a.length;n++)if(a[n].identifier===t){e=n;break}return e}function c(t,e){for(var n={},r=[],o=0;o<t.length;o++){var i=t[o],c=e.base?i[0]+e.base:i[0],u=n[c]||0,l="".concat(c," ").concat(u);n[c]=u+1;var p=s(l),f={css:i[1],media:i[2],sourceMap:i[3]};-1!==p?(a[p].references++,a[p].updater(f)):a.push({identifier:l,updater:y(f,e),references:1}),r.push(l)}return r}function u(t){var e=document.createElement("style"),r=t.attributes||{};if(void 0===r.nonce){var o=n.nc;o&&(r.nonce=o)}if(Object.keys(r).forEach((function(t){e.setAttribute(t,r[t])})),"function"==typeof t.insert)t.insert(e);else{var a=i(t.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(e)}return e}var l,p=(l=[],function(t,e){return l[t]=e,l.filter(Boolean).join("\n")});function f(t,e,n,r){var o=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(t.styleSheet)t.styleSheet.cssText=p(e,o);else{var i=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}function h(t,e,n){var r=n.css,o=n.media,i=n.sourceMap;if(o?t.setAttribute("media",o):t.removeAttribute("media"),i&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var d=null,v=0;function y(t,e){var n,r,o;if(e.singleton){var i=v++;n=d||(d=u(e)),r=f.bind(null,n,i,!1),o=f.bind(null,n,i,!0)}else n=u(e),r=h.bind(null,n,e),o=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else o()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=o());var n=c(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var r=0;r<n.length;r++){var o=s(n[r]);a[o].references--}for(var i=c(t,e),u=0;u<n.length;u++){var l=s(n[u]);0===a[l].references&&(a[l].updater(),a.splice(l,1))}n=i}}}},function(t,e,n){(e=n(7)(!1)).push([t.i,"*{margin:0;padding:0;box-sizing:border-box}.overflow-hidden{overflow-x:hidden;overflow-y:hidden}.float-left{float:left}.float-right{float:right}.select-none{user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.position-bottom{position:absolute;left:0;bottom:0}.coincide{position:absolute;top:0;left:0}body{width:100vw;height:100vh}body .text-center{text-align:center}body .landscape{width:100vw;height:100vh}body .controller{width:100vmax;height:40vmin}body .rocker-wrapper{width:100px;height:100px;margin-left:2rem;border-radius:100%;background:rgba(153,153,153,0.4)}body .rocker-wrapper .rocker{position:relative;top:25px;left:25px;width:50px;height:50px;border-radius:100%;background:#999}body .speed-up-wrap{width:100px;height:100px;margin-right:2rem}body .speed-up-wrap .speed-up{position:relative;top:25px;left:25px;width:70px;height:70px;border-radius:100%;background:rgba(240,107,107,0.7)}body .welcome{color:#666}body .welcome h1{padding:2rem}body .welcome button.start-game{position:relative;top:0;left:50%;margin-left:-50px;margin-top:3rem;width:100px;height:40px;border:1px dashed #888;color:#555}body .welcome .version-text{font-size:.8rem;padding:.3rem}@media screen and (orientation: portrait){body .landscape{width:100vmax;height:100vmin;transform-origin:top left;transform:rotate(90deg) translate(0, -100vmin)}body .turn{transform-origin:top left;transform:rotate(90deg) translate(0, -100vmin)}}\n",""]),t.exports=e},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var o=(a=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(c," */")),i=r.sources.map((function(t){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(t," */")}));return[n].concat(i).concat([o]).join("\n")}var a,s,c;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,r){"string"==typeof t&&(t=[[null,t,""]]);var o={};if(r)for(var i=0;i<this.length;i++){var a=this[i][0];null!=a&&(o[a]=!0)}for(var s=0;s<t.length;s++){var c=[].concat(t[s]);r&&o[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),e.push(c))}},e}},function(t,e,n){"use strict";n.r(e);n(4);var r=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},o=function(){function t(t,e){for(var n in void 0===t&&(t={}),void 0===e&&(e={}),this.entries=t,this.definitions={},this.entries.container=this,e)this.define(n,e[n])}return t.prototype.get=function(t){var e=this.entries[t];if(e)return e;var n=this.definitions[t];if(n)return this.entries[t]=n.apply(this),this.entries[t];throw new Error("There is no entry named "+t)},t.prototype.set=function(t,e){this.entries[t]=e},t.prototype.has=function(t){return Boolean(void 0===this.entries[t]&&void 0===this.definitions[t])},t.prototype.make=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this.definitions[t];if(r)return r.apply(this,e);throw new Error("There is no entry named "+t)},t.prototype.define=function(t,e){this.definitions[t]=e.bind(this)},t.prototype.invoke=function(t,e){for(var n=[],r=0,o=e;r<o.length;r++){var i=o[r];n.push(this.get(i))}return t.apply(n)},t.prototype.instance=function(t,e){void 0===e&&(e=[]);for(var n=[],o=0,i=e;o<i.length;o++){var a=i[o];n.push(this.get(a))}return new(t.bind.apply(t,r([void 0],n)))},t}();function i(t,e){var n=e-t,r=Math.random();return t+Math.round(r*n)}function a(t,e,n){void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=!1);var r=P.get("interfaceSize"),o=r[0],i=r[1],a=P.get("elementApp"),s=document.createElement("canvas");return s.width=null===t?o:t,s.height=null===e?i:e,n||(s.setAttribute("class","coincide"),a.appendChild(s)),s}var s,c,u=function(){function t(){this.observers=new Set}return t.prototype.register=function(t){this.observers.add(t)},t.prototype.remove=function(t){t.terminate&&t.terminate(),this.observers.delete(t)},t.prototype.notify=function(t){this.observers.forEach((function(e){e.update&&e.update(t),e.render&&e.needRepaint()&&(e.render(),e.repaint(!1))}))},t.prototype.terminate=function(){this.observers.forEach((function(t){t.terminate&&t.terminate()})),this.observers.clear()},t}(),l=function(){function t(t){this.subject=t,this.isRunning=!1,this.animationFrameId=0,this.process=this.process.bind(this)}return t.prototype.start=function(){this.isRunning||(this.isRunning=!0,requestAnimationFrame(this.process))},t.prototype.pause=function(){this.isRunning=!1,cancelAnimationFrame(this.animationFrameId)},t.prototype.stop=function(){this.isRunning=!1,this.subject.terminate(),cancelAnimationFrame(this.animationFrameId),this.stopHandle&&this.stopHandle.apply(this,this)},t.prototype.onStop=function(t){this.stopHandle=t},t.prototype.process=function(t){this.isRunning&&(this.subject.notify(t),this.animationFrameId=requestAnimationFrame(this.process))},t}(),p=2*Math.PI,f=Math.PI/180,h=function(){function t(t){this.canvas=t,this.context=t.getContext("2d")}return t.prototype.getContext=function(){return this.context},t.prototype.snakeHead=function(t,e,n,r){this.renderOuter(t,e,n,r);var o=this.context,i=n/2.3,a=n/1.8,s=n/1.8;o.save(),o.strokeStyle=r,o.fillStyle="white",o.beginPath(),o.arc(t+s,e-a,i,0,p),o.closePath(),o.fill(),o.stroke(),o.beginPath(),o.arc(t+s,e+a,i,0,p),o.closePath(),o.fill(),o.stroke(),o.fillStyle="black",o.beginPath(),o.arc(t+s,e-a,i/2,0,p),o.closePath(),o.fill(),o.beginPath(),o.arc(t+s,e+a,i/2,0,p),o.closePath(),o.fill();var c=i/3,u=t+s+c,l=e-a-c;o.fillStyle="white",o.beginPath(),o.arc(u,l,c,0,p),o.closePath(),o.fill(),l=e+a-c,o.beginPath(),o.arc(u,l,c,0,p),o.closePath(),o.fill(),o.restore()},t.prototype.snakeSection=function(t,e,n,r,o){var i=this.context;this.renderOuter(t,e,n,r),i.save(),i.fillStyle=o,i.beginPath(),i.arc(t,e,n/2,0,p),i.closePath(),i.fill(),i.restore()},t.prototype.food=function(t,e,n){var r=this.context;r.save(),r.fillStyle=n,r.beginPath(),r.arc(t,e,4,0,p),r.closePath(),r.fill(),r.restore()},t.prototype.mapBackground=function(t,e){var n=e/t,r=e/t,o=Math.max(n,r),i=this.context;i.beginPath(),i.lineWidth=.1,i.fillStyle="#aaa";for(var a=0;a<o;a++)a<n&&(i.moveTo(a*t,0),i.lineTo(a*t,e)),a<r&&(i.moveTo(0,a*t),i.lineTo(e,a*t));i.closePath(),i.stroke()},t.prototype.renderOuter=function(t,e,n,r){var o=this.context;o.save(),o.fillStyle=r,o.beginPath(),o.arc(t,e,n,0,p),o.closePath(),o.fill(),o.restore()},t.prototype.clearRect=function(t,e,n,r){this.context.clearRect(t,e,n,r)},t}();!function(t){t[t.Yellow=0]="Yellow",t[t.Red=1]="Red",t[t.Blue=2]="Blue",t[t.Cyan=3]="Cyan"}(s||(s={}));var d,v,y,m,g,b,x=((c={})[s.Red]=["#B22222","#8B0000"],c[s.Yellow]=["#FFD700","#DAA520"],c[s.Blue]=["#4682B4","#000080"],c[s.Cyan]=["#00CED1","#20B2AA"],c),w=function(){function t(){}return t.prototype.getMap=function(t,e){void 0===e&&(e=!0);var n=a(5e3,5e3,!0);e&&P.make("Graphical",n).mapBackground(20,t);return n},t.prototype.snakeHeadToCanvas=function(t,e){var n=a(e,e,!0);return P.make("Graphical",n).snakeHead(e/2,e/2,e/2,t),n},t.prototype.snakeSectionToCanvas=function(t,e,n){var r=a(n,n,!0),o=n/2;return P.make("Graphical",r).snakeSection(o,o,o,t,e),r},t}(),M=document.getElementById("app"),k=document.body,S=k.clientWidth,C=k.clientHeight,O=(d=S,v=C,y=Math.max(d,v),m=Math.min(d,v),(g=9*y/16)>m?[16*m/9,m]:[y,g]),j=new u,P=new o({elementApp:M,action:new l(j),subject:j,interfaceSize:O},{Graphical:function(t){return new h(t)},Material:function(){return new w}}),_=function(){return(_=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},A=function(){function t(){this.states={},this.history={},this.repaintState=!1,this.timeMap=new Map}return t.prototype.setStates=function(t){this.repaint(!0),this.states=_(_({},this.states),t)},t.prototype.getStates=function(){return this.states},t.prototype.getHistory=function(){return this.history},t.prototype.needRepaint=function(){return this.repaintState},t.prototype.repaint=function(t){this.repaintState=t,t&&(this.history=this.states)},t.prototype.isOvertime=function(t,e){return this.timeMap.has(e)||this.timeMap.set(e,0),e<=t-this.timeMap.get(e)&&(this.timeMap.set(e,t),!0)},t}(),B=(b=function(t,e){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}b(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),T=function(t){function e(n){var r=t.call(this)||this;r.food=n,r.x=0,r.y=0,r.canvas=a();var o=P.get("Material");return r.mapCanvas=o.getMap(e.mapSize),r.context=r.canvas.getContext("2d"),r.interfaceSize=P.get("interfaceSize"),r}return B(e,t),e.prototype.update=function(t){this.isOvertime(t,32)&&this.repaint(!0)},e.prototype.render=function(){var t=this.interfaceSize,e=t[0],n=t[1],r=this.x,o=this.y;this.context.clearRect(0,0,e,n),this.context.drawImage(this.mapCanvas,r,o,e,n,0,0,e,n)},e.prototype.updateMaxPosition=function(t,e){this.x=t,this.y=e,this.food.setStates({x:t,y:e})},e.prototype.terminate=function(){P.get("elementApp").removeChild(this.canvas)},e.mapSize=1200,e}(A),R=n(1),E=n.n(R),z=function(){function t(t,e,n){this.context=t,this.size=n;var r=P.get("Material"),o=x[e][0];this.sourceCanvas=r.snakeHeadToCanvas(o,n),this.sourceContext=this.sourceCanvas.getContext("2d"),this.sourceContext.globalAlpha=1;var i=n/2;this.offscreenCanvas=a(n,n,!0),this.offscreenContext=this.offscreenCanvas.getContext("2d"),this.offscreenContext.translate(i,i),this.offscreenContext.drawImage(this.sourceCanvas,-i,-i)}return t.prototype.rotate=function(t){var e=this.size,n=e/2,r=-n-5,o=e+10;this.offscreenContext.save(),this.offscreenContext.clearRect(r,r,o,o),this.offscreenContext.rotate(t*f),this.offscreenContext.drawImage(this.sourceCanvas,-n,-n),this.offscreenContext.restore()},t.prototype.clearRect=function(t,e,n){var r=n+10;this.context.clearRect(t-5,e-5,r,r)},t.prototype.render=function(t,e){this.context.drawImage(this.offscreenCanvas,t,e)},t}(),W=function(){function t(t,e,n){this.context=t,this.size=n,this.bodys=[],this.positions=[],this.isEnd=!0;var r=P.get("Material"),o=x[e],i=o[0],a=o[1];this.sourceCanvas=r.snakeSectionToCanvas(i,a,n)}return t.prototype.push=function(t,e){this.positions.push([t,e])},t.prototype.clear=function(){for(var t=0,e=this.bodys;t<e.length;t++){var n=e[t];this.context.clearRect(n.lastX-5,n.lastY-5,this.size+10,this.size+10)}},t.prototype.render=function(t,e){this.isEnd&&this.positions.shift();for(var n=[],r=0,o=this.bodys;r<o.length;r++){var i=o[r];if(0<=i.waitTime){i.waitTime-=1;break}var a=this.positions[i.position];if(a){var s=a[0],c=a[1];n.unshift([s,c]),i.isLast&&(this.isEnd=!0),this.isEnd||i.position++,i.lastX=s-t,i.lastY=c-e}}for(var u=0,l=n;u<l.length;u++){var p=l[u];s=p[0],c=p[1];this.context.drawImage(this.sourceCanvas,s-t,c-e)}},t.prototype.add=function(){var t=this.bodys[this.bodys.length-1],e=this.positions[0],n=e[0],r=e[1];t&&(t.isLast=!1,n=t.lastX,r=t.lastY),this.bodys.push({isLast:!0,lastX:n,lastY:r,waitTime:4,position:0}),this.isEnd=!1},t}(),I=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),F=function(t){function e(e,n){var r=t.call(this)||this;r.publicMap=e,r.food=n,r.waitTime=18,r.angleWorker=new E.a,r.scores=0,r.toAngle=0,r.angle=0,r.mapX=0,r.mapY=0,r.framerate=32,r.canvas=a(),r.context=r.canvas.getContext("2d");var o=i(s.Yellow,s.Cyan);r.snakeHead=new z(r.context,o,32),r.snakeBody=new W(r.context,o,32),r.food.onScoreAdded(r.handleScoreAdded.bind(r)),r.angleWorker.onmessage=r.handleAngleWorkerMessage.bind(r);var c=P.get("interfaceSize"),u=c[0],l=c[1];r.interfaceWidth=u,r.interfaceHeight=l;var p=Math.floor(u/2-16),f=Math.floor(l/2-16);r.setStates({x:p,y:f,size:32,speed:4}),r.snakeBody.push(p,f);for(var h=0;h<5;h++)r.snakeBody.add();return r}return I(e,t),e.prototype.update=function(t){if(this.isOvertime(t,this.framerate)){var e=this.getStates(),n=e.x,r=e.y,o=e.speed,i=e.size,a=this.toAngle,s=this.angle;s!==a&&(this.angleWorker.postMessage([s,a,o]),this.snakeHead.rotate(this.angle));var c=o*Math.cos(s*f)+n,u=o*Math.sin(s*f)+r;this.snakeBody.push(c,u);var l=i/2;this.mapX=c-this.interfaceWidth/2+l,this.mapY=u-this.interfaceHeight/2+l,this.publicMap.updateMaxPosition(this.mapX,this.mapY),this.food.onPositionChange(c,u,i);var p=T.mapSize-i;if(c<=0||u<=0||c>=p||u>=p)P.get("action").stop();this.setStates({x:c,y:u})}},e.prototype.render=function(){var t=this.getStates(),e=t.x,n=t.y,r=this.getHistory(),o=r.size,i=r.x,a=r.y,s=this.mapX,c=this.mapY;this.snakeBody.clear(),this.snakeHead.clearRect(i-s,a-c,o),this.snakeBody.render(s,c),this.snakeHead.render(e-s,n-c)},e.prototype.onCtrlAngleChange=function(t){this.toAngle=t},e.prototype.speedUp=function(){this.framerate=16},e.prototype.speedDown=function(){this.framerate=32},e.prototype.handleAngleWorkerMessage=function(t){this.angle=t.data},e.prototype.handleScoreAdded=function(){var t=this.scores,e=t;t>=10?(e=t-9,this.snakeBody.add()):e+=1,this.scores=e},e.prototype.terminate=function(){P.get("elementApp").removeChild(this.canvas),this.angleWorker.terminate()},e}(A),H=n(2),D=n.n(H),Y=function(){function t(t,e,n){this.elementRocker=t,this.elementSpeedUp=e,this.snake=n,this.top=25,this.left=25,this.startX=0,this.startY=0,this.ctrlAngleWorker=new D.a,t.ontouchstart=this.rockerTouchStart.bind(this),t.ontouchmove=this.rockerTouchMove.bind(this),t.ontouchend=this.rockerTouchEnd.bind(this),e.ontouchstart=this.speedUpStart.bind(this),e.ontouchend=this.speedUpEnd.bind(this),this.ctrlAngleWorker.onmessage=this.handleCtrlAngleWorkerMessage.bind(this),this.action=P.get("action");var r=document.body,o=r.clientWidth,i=r.clientHeight;this.isHorizon=Boolean(o>i)}return t.prototype.speedUpStart=function(t){t.preventDefault(),this.snake.speedUp()},t.prototype.speedUpEnd=function(t){t.preventDefault(),this.snake.speedDown()},t.prototype.rockerTouchStart=function(t){t.preventDefault();var e=t.targetTouches[0],n=e.clientX,r=e.clientY;this.startX=n,this.startY=r},t.prototype.rockerTouchMove=function(t){t.preventDefault();var e=t.targetTouches[0],n=e.clientX,r=e.clientY,o=this.getRockerOffset(n,r),i=o[0],a=o[1],s=this.left+i,c=this.top+a;this.elementRocker.style.left=s+"px",this.elementRocker.style.top=c+"px",this.ctrlAngleWorker.postMessage([n,r,i,a,this.startX,this.startY,this.isHorizon])},t.prototype.rockerTouchEnd=function(t){t.preventDefault(),this.elementRocker.style.top=this.top+"px",this.elementRocker.style.left=this.left+"px"},t.prototype.handleCtrlAngleWorkerMessage=function(t){this.snake.onCtrlAngleChange(t.data)},t.prototype.getRockerOffset=function(t,e){var n,r=document.body,o=r.clientWidth,i=r.clientHeight,a=t-this.startX,s=e-this.startY;o<i&&(a=(n=[s,-a])[0],s=n[1]);var c=Math.sqrt(Math.pow(a,2)+Math.pow(s,2));if(c>25){var u=25/c;a*=u,s*=u}return[a,s]},t.prototype.terminate=function(){this.ctrlAngleWorker.terminate()},t}(),U=n(3),L=n.n(U),X=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),N=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},q=["#F08080","#F5DEB3","#98FB98","#ADD8E6","#40E0D0","#FFC0CB","#DDA0DD"],G=function(t){function e(){var e=t.call(this)||this;e.foodNumber=T.mapSize/10,e.foods=[],e.animates=[],e.foodMoveWorker=new L.a,e.canvas=a(),e.context=e.canvas.getContext("2d");var n=P.get("Material");return e.mapCanvas=n.getMap(T.mapSize,!1),e.graphical=P.make("Graphical",e.mapCanvas),e.interfaceSize=P.get("interfaceSize"),e.foodMoveWorker.onmessage=e.handleFoodMoveWorkerMessage.bind(e),e.setStates({x:0,y:0,snx:0,sny:0}),e.buildTree(),e.randomFood(),e}return X(e,t),e.prototype.update=function(t){var e=this.getStates(),n=e.snx,r=e.sny;for(var o in this.animates){var i=this.animates[o],a=i[0],s=i[1],c=i[2];this.graphical.clearRect(a-10,s-10,16,16);var u=r-s,l=n-a,p=Math.abs(l/u)*(l<0?-1:1)+a,f=(u<0?-1:1)+s;this.animates[o]=[p,f,c],Math.sqrt(Math.pow(l,2)+Math.pow(u,2))<=10&&(delete this.animates[o],this.makeFood())}},e.prototype.render=function(){var t=this.interfaceSize,e=t[0],n=t[1],r=this.getStates(),o=r.x,i=r.y;for(var a in this.context.clearRect(0,0,e,n),this.animates){var s=this.animates[a],c=s[0],u=s[1],l=s[2];this.graphical.food(c,u,l)}this.context.drawImage(this.mapCanvas,o,i,e,n,0,0,e,n)},e.prototype.onPositionChange=function(t,e,n){var r=T.mapSize/100-1,o=100*Math.floor(t/100),i=[o];t-o<10&&o>0&&i.push(o-1),o<r&&t+n+10>o+1&&i.push(o+1);for(var a=0,s=i;a<s.length;a++){var c=s[a],u=this.foods[c];for(var l in u){var p=u[l],f=p[0],h=p[1];this.foodMoveWorker.postMessage([t,e,n,f,h,c,l])}}this.setStates({snx:t,sny:e})},e.prototype.onScoreAdded=function(t){this.handleScoreAdded=t},e.prototype.handleFoodMoveWorkerMessage=function(t){var e=t.data,n=e[0],r=e[1],o=this.foods[n][r];o&&(this.animates.push(N(o)),delete this.foods[n][r],this.handleScoreAdded&&this.handleScoreAdded())},e.prototype.buildTree=function(){for(var t=T.mapSize/100,e=0;e<t;e++)this.foods[100*e]=[]},e.prototype.randomFood=function(){for(var t=0;t<this.foodNumber;t++)this.makeFood()},e.prototype.makeFood=function(){var t=i(4,T.mapSize-4),e=i(4,T.mapSize-4),n=i(0,q.length-1);this.graphical.food(t,e,q[n]);var r=100*Math.floor(t/100);this.foods[r].push([t,e,q[n]])},e.prototype.terminate=function(){P.get("elementApp").removeChild(this.canvas)},e}(A),J=document.getElementById("rocker"),K=document.getElementById("speed-up"),Q=document.getElementById("start-game"),V=document.getElementById("welcome"),Z=document.getElementById("game-over-confirm"),$=document.getElementById("gameover"),tt=P.get("action"),et=P.get("subject");Q.onclick=function(t){V.style.display="none";var e=new G;et.register(e);var n=new T(e);et.register(n);var r=new F(n,e);et.register(r);var o=new Y(J,K,r);tt.onStop((function(){o.terminate(),$.style.display="block"})),tt.start()},Z.onclick=function(t){$.style.display="none",V.style.display="block"},Q.style.display="block"}]);