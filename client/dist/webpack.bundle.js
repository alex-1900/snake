(()=>{"use strict";var t={365:(t,e,n)=>{n.d(e,{Z:()=>s});var o=n(81),r=n.n(o),i=n(645),a=n.n(i)()(r());a.push([t.id,"*{margin:0;padding:0;box-sizing:border-box}.overflow-hidden{overflow-x:hidden;overflow-y:hidden}.float-left{float:left}.float-right{float:right}.select-none{user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.position-bottom{position:absolute;left:0;bottom:0}.coincide{position:absolute;top:0;left:0}body{width:100vw;height:100vh}body .text-center{text-align:center}body .landscape{width:100vw;height:100vh}body .controller{width:100vmax;height:40vmin}body .rocker-wrapper{width:100px;height:100px;margin-left:2rem;border-radius:100%;background:rgba(153,153,153,.4)}body .rocker-wrapper .rocker{position:relative;top:25px;left:25px;width:50px;height:50px;border-radius:100%;background:#999}body .speed-up-wrap{width:100px;height:100px;margin-right:2rem}body .speed-up-wrap .speed-up{position:relative;top:25px;left:25px;width:70px;height:70px;border-radius:100%;background:rgba(240,107,107,.7)}body .welcome{color:#666}body .welcome h1{padding:2rem}body .welcome button.start-game{position:relative;top:0;left:50%;margin-left:-50px;margin-top:3rem;width:100px;height:40px;border:1px dashed #888;color:#555}body .welcome .version-text{font-size:.8rem;padding:.3rem}@media screen and (orientation: portrait){body .landscape{width:100vmax;height:100vmin;transform-origin:top left;transform:rotate(90deg) translate(0, -100vmin)}body .turn{transform-origin:top left;transform:rotate(90deg) translate(0, -100vmin)}}",""]);const s=a},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",o=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),o&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),o&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,o,r,i){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(o)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var p=0;p<t.length;p++){var h=[].concat(t[p]);o&&a[h[0]]||(void 0!==i&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=i),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),r&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=r):h[4]="".concat(r)),e.push(h))}},e}},81:t=>{t.exports=function(t){return t[1]}},379:t=>{var e=[];function n(t){for(var n=-1,o=0;o<e.length;o++)if(e[o].identifier===t){n=o;break}return n}function o(t,o){for(var i={},a=[],s=0;s<t.length;s++){var c=t[s],p=o.base?c[0]+o.base:c[0],h=i[p]||0,l="".concat(p," ").concat(h);i[p]=h+1;var u=n(l),f={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==u)e[u].references++,e[u].updater(f);else{var d=r(f,o);o.byIndex=s,e.splice(s,0,{identifier:l,updater:d,references:1})}a.push(l)}return a}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var i=o(t=t||[],r=r||{});return function(t){t=t||[];for(var a=0;a<i.length;a++){var s=n(i[a]);e[s].references--}for(var c=o(t,r),p=0;p<i.length;p++){var h=n(i[p]);0===e[h].references&&(e[h].updater(),e.splice(h,1))}i=c}}},569:t=>{var e={};t.exports=function(t,n){var o=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},216:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,r&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(o,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={id:o,exports:{}};return t[o](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0,(()=>{var t=n(379),e=n.n(t),o=n(795),r=n.n(o),i=n(569),a=n.n(i),s=n(565),c=n.n(s),p=n(216),h=n.n(p),l=n(589),u=n.n(l),f=n(365),d={};d.styleTagTransform=u(),d.setAttributes=c(),d.insert=a().bind(null,"head"),d.domAPI=r(),d.insertStyleElement=h(),e()(f.Z,d),f.Z&&f.Z.locals&&f.Z.locals;const v=function(){function t(t,e){for(var n in void 0===t&&(t={}),void 0===e&&(e={}),this.entries=t,this.definitions={},this.entries.container=this,e)this.define(n,e[n])}return t.prototype.get=function(t){var e=this.entries[t];if(e)return e;var n=this.definitions[t];if(n)return this.entries[t]=n.apply(this),this.entries[t];throw new Error("There is no entry named ".concat(t))},t.prototype.set=function(t,e){this.entries[t]=e},t.prototype.has=function(t){return Boolean(void 0===this.entries[t]&&void 0===this.definitions[t])},t.prototype.make=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var o=this.definitions[t];if(o)return o.apply(this,e);throw new Error("There is no entry named ".concat(t))},t.prototype.define=function(t,e){this.definitions[t]=e.bind(this)},t.prototype.invoke=function(t,e){for(var n=[],o=0,r=e;o<r.length;o++){var i=r[o];n.push(this.get(i))}return t.apply(n)},t.prototype.instance=function(t,e){void 0===e&&(e=[]);for(var n=[],o=0,r=e;o<r.length;o++){var i=r[o];n.push(this.get(i))}return new(t.bind.apply(t,function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}([void 0],n,!1)))},t}();function y(t,e){var n=e-t,o=Math.random();return t+Math.round(o*n)}function m(t,e,n){void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=!1);var o=H.get("interfaceSize"),r=o[0],i=o[1],a=H.get("elementApp"),s=document.createElement("canvas");return s.width=null===t?r:t,s.height=null===e?i:e,n||(s.setAttribute("class","coincide"),a.appendChild(s)),s}const g=function(){function t(){this.observers=new Set}return t.prototype.register=function(t){this.observers.add(t)},t.prototype.remove=function(t){t.terminate&&t.terminate(),this.observers.delete(t)},t.prototype.notify=function(t){this.observers.forEach((function(e){e.update&&e.update(t),e.render&&e.needRepaint()&&(e.render(),e.repaint(!1))}))},t.prototype.terminate=function(){this.observers.forEach((function(t){t.terminate&&t.terminate()})),this.observers.clear()},t}();var b=function(){function t(t){this.subject=t,this.isRunning=!1,this.animationFrameId=0,this.process=this.process.bind(this)}return t.prototype.start=function(){this.isRunning||(this.isRunning=!0,requestAnimationFrame(this.process))},t.prototype.pause=function(){this.isRunning=!1,cancelAnimationFrame(this.animationFrameId)},t.prototype.stop=function(){this.isRunning=!1,this.subject.terminate(),cancelAnimationFrame(this.animationFrameId),this.stopHandle&&this.stopHandle.apply(this,this)},t.prototype.onStop=function(t){this.stopHandle=t},t.prototype.process=function(t){this.isRunning&&(this.subject.notify(t),this.animationFrameId=requestAnimationFrame(this.process))},t}();const x=b;var w=2*Math.PI,k=Math.PI/180,M=32;const S=function(){function t(t){this.canvas=t,this.context=t.getContext("2d")}return t.prototype.getContext=function(){return this.context},t.prototype.snakeHead=function(t,e,n,o){this.renderOuter(t,e,n,o);var r=this.context,i=n/2.3,a=n/1.8,s=n/1.8;r.save(),r.strokeStyle=o,r.fillStyle="white",r.beginPath(),r.arc(t+s,e-a,i,0,w),r.closePath(),r.fill(),r.stroke(),r.beginPath(),r.arc(t+s,e+a,i,0,w),r.closePath(),r.fill(),r.stroke(),r.fillStyle="black",r.beginPath(),r.arc(t+s,e-a,i/2,0,w),r.closePath(),r.fill(),r.beginPath(),r.arc(t+s,e+a,i/2,0,w),r.closePath(),r.fill();var c=i/3,p=t+s+c,h=e-a-c;r.fillStyle="white",r.beginPath(),r.arc(p,h,c,0,w),r.closePath(),r.fill(),h=e+a-c,r.beginPath(),r.arc(p,h,c,0,w),r.closePath(),r.fill(),r.restore()},t.prototype.snakeSection=function(t,e,n,o,r){var i=this.context;this.renderOuter(t,e,n,o),i.save(),i.fillStyle=r,i.beginPath(),i.arc(t,e,n/2,0,w),i.closePath(),i.fill(),i.restore()},t.prototype.food=function(t,e,n){var o=this.context;o.save(),o.fillStyle=n,o.beginPath(),o.arc(t,e,4,0,w),o.closePath(),o.fill(),o.restore()},t.prototype.mapBackground=function(t,e){var n=e/t,o=e/t,r=Math.max(n,o),i=this.context;i.beginPath(),i.lineWidth=.1,i.fillStyle="#aaa";for(var a=0;a<r;a++)a<n&&(i.moveTo(a*t,0),i.lineTo(a*t,e)),a<o&&(i.moveTo(0,a*t),i.lineTo(e,a*t));i.closePath(),i.stroke()},t.prototype.renderOuter=function(t,e,n,o){var r=this.context;r.save(),r.fillStyle=o,r.beginPath(),r.arc(t,e,n,0,w),r.closePath(),r.fill(),r.restore()},t.prototype.clearRect=function(t,e,n,o){this.context.clearRect(t,e,n,o)},t}();var C,A;!function(t){t[t.Yellow=0]="Yellow",t[t.Red=1]="Red",t[t.Blue=2]="Blue",t[t.Cyan=3]="Cyan"}(C||(C={}));var P=((A={})[C.Red]=["#B22222","#8B0000"],A[C.Yellow]=["#FFD700","#DAA520"],A[C.Blue]=["#4682B4","#000080"],A[C.Cyan]=["#00CED1","#20B2AA"],A);const E=function(){function t(){}return t.prototype.getMap=function(t,e){void 0===e&&(e=!0);var n=m(5e3,5e3,!0);return e&&H.make("Graphical",n).mapBackground(20,t),n},t.prototype.snakeHeadToCanvas=function(t,e){var n=m(e,e,!0);return H.make("Graphical",n).snakeHead(e/2,e/2,e/2,t),n},t.prototype.snakeSectionToCanvas=function(t,e,n){var o=m(n,n,!0),r=n/2;return H.make("Graphical",o).snakeSection(r,r,r,t,e),o},t}();var T,O,R,B,I,_=document.getElementById("app"),F=document.body,z=(T=F.clientWidth,O=F.clientHeight,R=Math.max(T,O),B=Math.min(T,O),(I=9*R/16)>B?[16*B/9,B]:[R,I]),W=new g;const H=new v({elementApp:_,action:new x(W),subject:W,interfaceSize:z},{Graphical:function(t){return new S(t)},Material:function(){return new E}});var j=function(){return j=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},j.apply(this,arguments)};const D=function(){function t(){this.states={},this.history={},this.repaintState=!1,this.timeMap=new Map}return t.prototype.setStates=function(t){this.repaint(!0),this.states=j(j({},this.states),t)},t.prototype.getStates=function(){return this.states},t.prototype.getHistory=function(){return this.history},t.prototype.needRepaint=function(){return this.repaintState},t.prototype.repaint=function(t){this.repaintState=t,t&&(this.history=this.states)},t.prototype.isOvertime=function(t,e){return this.timeMap.has(e)||this.timeMap.set(e,0),e<=t-this.timeMap.get(e)&&(this.timeMap.set(e,t),!0)},t}();var Y,X=(Y=function(t,e){return Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Y(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Y(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),L=function(t){function e(n){var o=t.call(this)||this;o.food=n,o.x=0,o.y=0,o.canvas=m();var r=H.get("Material");return o.mapCanvas=r.getMap(e.mapSize),o.context=o.canvas.getContext("2d"),o.interfaceSize=H.get("interfaceSize"),o}return X(e,t),e.prototype.update=function(t){this.isOvertime(t,32)&&this.repaint(!0)},e.prototype.render=function(){var t=this.interfaceSize,e=t[0],n=t[1],o=this.x,r=this.y;this.context.clearRect(0,0,e,n),this.context.drawImage(this.mapCanvas,o,r,e,n,0,0,e,n)},e.prototype.updateMaxPosition=function(t,e){this.x=t,this.y=e,this.food.setStates({x:t,y:e})},e.prototype.terminate=function(){H.get("elementApp").removeChild(this.canvas)},e.mapSize=1200,e}(D);const U=L;var q=self;q.addEventListener("message",(function(t){var e=t.data,n=e[0],o=e[1],r=n,i=2.8*e[2],a=o-n,s=Math.abs(a),c=Math.min(s,i);s<=180?r+=a>0?c:-c:s>180&&(r+=a>0?-c:c),r>360&&(r-=360),r<0&&(r+=360),s<i&&(r=o),q.postMessage(Math.floor(r))}));const N=function(){function t(t,e){this.context=t;var n=H.get("Material"),o=P[e][0];this.sourceCanvas=n.snakeHeadToCanvas(o,M),this.sourceContext=this.sourceCanvas.getContext("2d"),this.sourceContext.globalAlpha=1,this.offscreenCanvas=m(M,M,!0),this.offscreenContext=this.offscreenCanvas.getContext("2d"),this.offscreenContext.translate(16,16),this.offscreenContext.drawImage(this.sourceCanvas,-16,-16)}return t.prototype.rotate=function(t){this.offscreenContext.save(),this.offscreenContext.clearRect(-21,-21,42,42),this.offscreenContext.rotate(t*k),this.offscreenContext.drawImage(this.sourceCanvas,-16,-16),this.offscreenContext.restore()},t.prototype.clearRect=function(t,e){this.context.clearRect(t-5,e-5,42,42)},t.prototype.render=function(t,e){this.context.drawImage(this.offscreenCanvas,t,e)},t}();var G=function(){function t(t,e){this.context=t,this.bodys=[],this.positions=[],this.isEnd=!0;var n=H.get("Material"),o=P[e],r=o[0],i=o[1];this.sourceCanvas=n.snakeSectionToCanvas(r,i,M)}return t.prototype.push=function(t,e){this.positions.push([t,e])},t.prototype.clear=function(){for(var t=0,e=this.bodys;t<e.length;t++){var n=e[t];this.context.clearRect(n.lastX-5,n.lastY-5,42,42)}},t.prototype.render=function(t,e){this.isEnd&&this.positions.shift();for(var n=[],o=0,r=this.bodys;o<r.length;o++){var i=r[o];if(0<=i.waitTime){i.waitTime-=1;break}var a=this.positions[i.position];if(a){var s=a[0],c=a[1];n.unshift([s,c]),i.isLast&&(this.isEnd=!0),this.isEnd||i.position++,i.lastX=s-t,i.lastY=c-e}}for(var p=0,h=n;p<h.length;p++){var l=h[p];s=l[0],c=l[1],this.context.drawImage(this.sourceCanvas,s-t,c-e)}},t.prototype.add=function(){var t=this.bodys[this.bodys.length-1],e=this.positions[0],n=e[0],o=e[1];t&&(t.isLast=!1,n=t.lastX,o=t.lastY),this.bodys.push({isLast:!0,lastX:n,lastY:o,waitTime:4,position:0}),this.isEnd=!1},t}();const Z=G;var J=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),K=function(t){function e(e,n){var o=t.call(this)||this;o.food=e,o.publicMap=n,o.angleWorker=new null,o.scores=0,o.toAngle=0,o.angle=0,o.mapX=0,o.mapY=0,o.framerate=32,o.canvas=m(),o.context=o.canvas.getContext("2d");var r=y(C.Yellow,C.Cyan);o.snakeHead=new N(o.context,r),o.snakeBody=new Z(o.context,r),o.food.onScoreAdded(o.handleScoreAdded.bind(o)),o.angleWorker.onmessage=o.handleAngleWorkerMessage.bind(o);var i=H.get("interfaceSize"),a=i[0],s=i[1];o.interfaceWidth=a,o.interfaceHeight=s;var c=Math.floor(a/2-16),p=Math.floor(s/2-16);o.setStates({x:c,y:p,speed:4}),o.snakeBody.push(c,p);for(var h=0;h<5;h++)o.snakeBody.add();return o}return J(e,t),e.prototype.update=function(t){if(this.isOvertime(t,this.framerate)){var e=this.getStates(),n=e.x,o=e.y,r=e.speed,i=this.toAngle,a=this.angle;a!==i&&(this.angleWorker.postMessage([a,i,r]),this.snakeHead.rotate(this.angle));var s=r*Math.cos(a*k)+n,c=r*Math.sin(a*k)+o;this.snakeBody.push(s,c),this.mapX=s-this.interfaceWidth/2+16,this.mapY=c-this.interfaceHeight/2+16,this.publicMap.updateMaxPosition(this.mapX,this.mapY),this.food.onPositionChange(s,c);var p=U.mapSize-M;(s<=0||c<=0||s>=p||c>=p)&&H.get("action").stop(),this.setStates({x:s,y:c})}},e.prototype.render=function(){var t=this.getStates(),e=t.x,n=t.y,o=this.getHistory(),r=o.x,i=o.y,a=this.mapX,s=this.mapY;this.snakeBody.clear(),this.snakeHead.clearRect(r-a,i-s),this.snakeBody.render(a,s),this.snakeHead.render(e-a,n-s)},e.prototype.onCtrlAngleChange=function(t){this.toAngle=t},e.prototype.speedUp=function(){this.framerate=16},e.prototype.speedDown=function(){this.framerate=32},e.prototype.handleAngleWorkerMessage=function(t){this.angle=t.data},e.prototype.handleScoreAdded=function(){var t=this.scores,e=t;t>=10?(e=t-9,this.snakeBody.add()):e+=1,this.scores=e},e.prototype.terminate=function(){H.get("elementApp").removeChild(this.canvas),this.angleWorker.terminate()},e}(D);const Q=K;var V=self,$=180/Math.PI;V.addEventListener("message",(function(t){var e=t.data,n=e[0],o=e[1],r=e[2],i=e[3],a=e[4],s=e[5],c=e[6];V.postMessage(function(t,e,n,o,r,i,a){return t>r&&e>i?Math.floor(Math.atan(o/n)*$)+(a?0:360):t<r&&e>i?Math.floor(Math.atan(-n/o)*$)+90:t<r&&e<i?Math.floor(Math.atan(-o/-n)*$)+180:t>r&&e<i?Math.floor(Math.atan(-n/o)*$)+270:0}(n,o,r,i,a,s,c))}));var tt=function(){function t(t,e,n){this.elementRocker=t,this.elementSpeedUp=e,this.snake=n,this.top=25,this.left=25,this.startX=0,this.startY=0,this.ctrlAngleWorker=new null,t.ontouchstart=this.rockerTouchStart.bind(this),t.ontouchmove=this.rockerTouchMove.bind(this),t.ontouchend=this.rockerTouchEnd.bind(this),e.ontouchstart=this.speedUpStart.bind(this),e.ontouchend=this.speedUpEnd.bind(this),this.ctrlAngleWorker.onmessage=this.handleCtrlAngleWorkerMessage.bind(this),this.action=H.get("action");var o=document.body,r=o.clientWidth,i=o.clientHeight;this.isHorizon=Boolean(r>i)}return t.prototype.speedUpStart=function(t){t.preventDefault(),this.snake.speedUp()},t.prototype.speedUpEnd=function(t){t.preventDefault(),this.snake.speedDown()},t.prototype.rockerTouchStart=function(t){t.preventDefault();var e=t.targetTouches[0],n=e.clientX,o=e.clientY;this.startX=n,this.startY=o},t.prototype.rockerTouchMove=function(t){t.preventDefault();var e=t.targetTouches[0],n=e.clientX,o=e.clientY,r=this.getRockerOffset(n,o),i=r[0],a=r[1],s=this.left+i,c=this.top+a;this.elementRocker.style.left="".concat(s,"px"),this.elementRocker.style.top="".concat(c,"px"),this.ctrlAngleWorker.postMessage([n,o,i,a,this.startX,this.startY,this.isHorizon])},t.prototype.rockerTouchEnd=function(t){t.preventDefault(),this.elementRocker.style.top=this.top+"px",this.elementRocker.style.left=this.left+"px"},t.prototype.handleCtrlAngleWorkerMessage=function(t){this.snake.onCtrlAngleChange(t.data)},t.prototype.getRockerOffset=function(t,e){var n,o=document.body,r=o.clientWidth,i=o.clientHeight,a=t-this.startX,s=e-this.startY;r<i&&(a=(n=[s,-a])[0],s=n[1]);var c=Math.sqrt(Math.pow(a,2)+Math.pow(s,2));if(c>25){var p=25/c;a*=p,s*=p}return[a,s]},t.prototype.terminate=function(){this.ctrlAngleWorker.terminate()},t}();const et=tt;var nt=self;nt.addEventListener("message",(function(t){var e,n,o,r,i,a,s=t.data,c=s[0],p=s[1],h=s[2],l=s[3],u=s[4],f=s[5],d=s[6],v=h/2;e=c+v,n=p+v,o=v,r=l,i=u,a=Math.sqrt(Math.pow(e-r,2)+Math.pow(n-i,2)),Boolean(o+4+40>=a)&&nt.postMessage([f,d])}));var ot=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),rt=["#F08080","#F5DEB3","#98FB98","#ADD8E6","#40E0D0","#FFC0CB","#DDA0DD"],it=100,at=function(t){function e(){var e=t.call(this)||this;e.foodNumber=U.mapSize/10,e.foods=[],e.animates=[],e.foodMoveWorker=new null,e.canvas=m(),e.context=e.canvas.getContext("2d");var n=H.get("Material");return e.mapCanvas=n.getMap(U.mapSize,!1),e.graphical=H.make("Graphical",e.mapCanvas),e.interfaceSize=H.get("interfaceSize"),e.foodMoveWorker.onmessage=e.handleFoodMoveWorkerMessage.bind(e),e.setStates({x:0,y:0,snx:0,sny:0}),e.buildTree(),e.randomFood(),e}return ot(e,t),e.prototype.update=function(t){var e=this.getStates(),n=e.snx,o=e.sny;for(var r in this.animates){var i=this.animates[r],a=i[0],s=i[1],c=i[2];this.graphical.clearRect(a-10,s-10,16,16);var p=o+16-s,h=n+16-a,l=Math.abs(h/p)*(h<0?-1:1)+a,u=(p<0?-1:1)+s;this.animates[r]=[l,u,c],Math.sqrt(Math.pow(h,2)+Math.pow(p,2))<=10&&(delete this.animates[r],this.makeFood())}},e.prototype.render=function(){var t=this.interfaceSize,e=t[0],n=t[1],o=this.getStates(),r=o.x,i=o.y;for(var a in this.context.clearRect(0,0,e,n),this.animates){var s=this.animates[a],c=s[0],p=s[1],h=s[2];this.graphical.food(c,p,h)}this.context.drawImage(this.mapCanvas,r,i,e,n,0,0,e,n)},e.prototype.onPositionChange=function(t,e){var n=U.mapSize/it-1,o=Math.floor(t/it)*it,r=[o];t-o<10&&o>0&&r.push(o-1),o<n&&t+M+10>o+1&&r.push(o+1);for(var i=0,a=r;i<a.length;i++){var s=a[i],c=this.foods[s];for(var p in c){var h=c[p],l=h[0],u=h[1];this.foodMoveWorker.postMessage([t,e,M,l,u,s,p])}}this.setStates({snx:t,sny:e})},e.prototype.onScoreAdded=function(t){this.handleScoreAdded=t},e.prototype.handleFoodMoveWorkerMessage=function(t){var e=t.data,n=e[0],o=e[1],r=this.foods[n][o];r&&(this.animates.push(function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}([],r,!0)),delete this.foods[n][o],this.handleScoreAdded&&this.handleScoreAdded())},e.prototype.buildTree=function(){for(var t=U.mapSize/it,e=0;e<t;e++)this.foods[e*it]=[]},e.prototype.randomFood=function(){for(var t=0;t<this.foodNumber;t++)this.makeFood()},e.prototype.makeFood=function(){var t=y(4,U.mapSize-4),e=y(4,U.mapSize-4),n=y(0,rt.length-1);this.graphical.food(t,e,rt[n]);var o=Math.floor(t/it)*it;this.foods[o].push([t,e,rt[n]])},e.prototype.terminate=function(){H.get("elementApp").removeChild(this.canvas)},e}(D);const st=at;var ct=document.getElementById("rocker"),pt=document.getElementById("speed-up"),ht=document.getElementById("start-game"),lt=document.getElementById("welcome"),ut=document.getElementById("game-over-confirm"),ft=document.getElementById("gameover"),dt=H.get("action"),vt=H.get("subject");ht.onclick=function(t){lt.style.display="none";var e=new st;vt.register(e);var n=new U(e);vt.register(n);var o=new Q(e,n);vt.register(o);var r=new et(ct,pt,o);dt.onStop((function(){r.terminate(),ft.style.display="block"})),dt.start()},ut.onclick=function(t){ft.style.display="none",lt.style.display="block"},ht.style.display="block"})()})();